annotate("text", x = .75, y = .25,
label = paste("AUC =", round(calc_auc(basicplot)$AUC, 2))) +
scale_x_continuous("1 - Specificity", breaks = seq(0, 1, by = .05))
basicplot +
style_roc(theme = theme_grey) +
theme(axis.text = element_text(colour = "blue")) +
ggtitle("PTSD Diagnosis") +
annotate("text", x = .75, y = .25,
label = paste("AUC =", round(calc_auc(basicplot)$AUC, 2))) +
scale_x_continuous("1 - Specificity", breaks = seq(0, 1, by = .05))
rocdata <- data.frame(D = all_paths$PTSD,
M = all_paths$pC_LIPL)
basicplot <- ggplot(rocdata, aes(m = M, d = D)) + geom_roc()
basicplot
rocdata <- data.frame(D = all_paths$PTSD,
M = all_paths$pC_LIPL + all_paths$PCC_MPFG + all_paths$pC_LMFG)
basicplot <- ggplot(rocdata, aes(m = M, d = D)) + geom_roc()
basicplot
basicplot +
style_roc(theme = theme_grey) +
theme(axis.text = element_text(colour = "blue")) +
ggtitle("PTSD Diagnosis") +
annotate("text", x = .75, y = .25,
label = paste("AUC =", round(calc_auc(basicplot)$AUC, 2))) +
scale_x_continuous("1 - Specificity", breaks = seq(0, 1, by = .05))
rocdata <- data.frame(D = all_paths$PTSD,
M = all_paths$pC_LIPL)
basicplot <- ggplot(rocdata, aes(m = M, d = D)) + geom_roc()
basicplot
basicplot +
style_roc(theme = theme_grey) +
theme(axis.text = element_text(colour = "blue")) +
ggtitle("PTSD Diagnosis") +
annotate("text", x = .75, y = .25,
label = paste("AUC =", round(calc_auc(basicplot)$AUC, 2))) +
scale_x_continuous("1 - Specificity", breaks = seq(0, 1, by = .05))
ROC(form=all_paths$PTSD~all_paths$pC_LIPL+all_paths$PCC_MPFG+all_paths$pC_LMFG)
rocdata <- data.frame(D = all_paths$PTSD,
M = all_paths$pC_LIPL + all_paths$PCC_MPFG + all_paths$pC_LMFG)
basicplot <- ggplot(rocdata, aes(m = M, d = D)) + geom_roc()
basicplot
basicplot +
style_roc(theme = theme_grey) +
theme(axis.text = element_text(colour = "blue")) +
ggtitle("PTSD Diagnosis") +
annotate("text", x = .75, y = .25,
label = paste("AUC =", round(calc_auc(basicplot)$AUC, 2))) +
scale_x_continuous("1 - Specificity", breaks = seq(0, 1, by = .05))
all_paths <- read.csv("/Users/thomasvanasse/Google Drive/Research/PTSD/Log_Regression/sig_coefficients_v1.csv")
ROC(form=all_paths$PTSD~all_paths$pC_LIPL+all_paths$PCC_MPFG+all_paths$pC_LMFG)
all_paths <- read.csv("/Users/thomasvanasse/Google Drive/Research/PTSD/Log_Regression/sig_coefficients_v1_noCC.csv")
ROC(form=all_paths$PTSD~all_paths$pC_LIPL+all_paths$PCC_MPFG+all_paths$pC_LMFG)
all_paths <- read.csv("/Users/thomasvanasse/Google Drive/Research/PTSD/Log_Regression/sig_coefficients_v1.csv")
ROC(form=all_paths$PTSD~all_paths$pC_LIPL+all_paths$PCC_MPFG+all_paths$pC_LMFG)
ROC(form=all_paths$all_paths$pC_LMFG)
ROC(form=all_paths$PTSD~all_paths$pC_LMFG)
rocdata <- data.frame(D = all_paths$PTSD,
M = all_paths$pC_LIPL + all_paths$PCC_MPFG + all_paths$pC_LMFG)
basicplot <- ggplot(rocdata, aes(m = M, d = D)) + geom_roc()
basicplot
basicplot +
style_roc(theme = theme_grey) +
theme(axis.text = element_text(colour = "blue")) +
ggtitle("PTSD Diagnosis") +
annotate("text", x = .75, y = .25,
label = paste("AUC =", round(calc_auc(basicplot)$AUC, 2))) +
scale_x_continuous("1 - Specificity", breaks = seq(0, 1, by = .05))
all_paths <- read.csv("/Users/thomasvanasse/Google Drive/Research/PTSD/Log_Regression/sig_coefficients_v1.csv")
ROC(form=all_paths$PTSD~all_paths$pC_LMFG)
rocdata <- data.frame(D = all_paths$PTSD,
M = all_paths$pC_LIPL + all_paths$PCC_MPFG + all_paths$pC_LMFG)
rocdata <- data.frame(D = all_paths$PTSD,
M = all_paths$pC_LIPL_Z. + all_paths$PCC_MPFG_Z. + all_paths$pC_LMFG_Z.)
basicplot <- ggplot(rocdata, aes(m = M, d = D)) + geom_roc()
basicplot
basicplot +
style_roc(theme = theme_grey) +
theme(axis.text = element_text(colour = "blue")) +
ggtitle("PTSD Diagnosis") +
annotate("text", x = .75, y = .25,
label = paste("AUC =", round(calc_auc(basicplot)$AUC, 2))) +
scale_x_continuous("1 - Specificity", breaks = seq(0, 1, by = .05))
rocdata <- data.frame(D = all_paths$PTSD,
M = all_paths$pC_LIPL_Z + all_paths$PCC_MPFG_Z + all_paths$pC_LMFG_Z)
basicplot <- ggplot(rocdata, aes(m = M, d = D)) + geom_roc()
basicplot
basicplot +
style_roc(theme = theme_grey) +
theme(axis.text = element_text(colour = "blue")) +
ggtitle("PTSD Diagnosis") +
annotate("text", x = .75, y = .25,
label = paste("AUC =", round(calc_auc(basicplot)$AUC, 2))) +
scale_x_continuous("1 - Specificity", breaks = seq(0, 1, by = .05))
fit1 = glm(all_paths_LR$PTSD ~ all_paths_LR$`pC --> LMFG` + all_paths_LR$`pC --> LIPL`, family = 'binomial')
roc1=roc(fit1$y, fit1$linear.predictors)
fit2 = glm(all_paths_LR$PTSD ~ all_paths_LR$`pC --> LMFG` + all_paths_LR$`pC --> LIPL`, family = 'binomial')
roc2=roc(fit1$y, fit1$linear.predictors, ci=TRUE)
fit3 = glm(LR_path$PTSD ~ LR_path$Effect, family = 'binomial')
preds3=predict(fit3)
roc3=roc(all_paths_LR$PTSD ~ preds3)
plot(roc1, col = 'blue')
plot(roc2,add = TRUE, col='red')
plot(roc3, add = TRUE, col = 'yellow')
roc1$auc
roc2$auc
roc3$auc
summary(fit1)
summary(fit2)
summary(fit3)
all_paths <- read.csv("/Users/thomasvanasse/Google Drive/Research/PTSD/Log_Regression/sig_coefficients_v1.csv")
ROC(form=all_paths$PTSD~all_paths$pC_LMFG_Z)
rocdata <- data.frame(D = all_paths$PTSD,
M = all_paths$pC_LIPL_Z + all_paths$PCC_MPFG_Z + all_paths$pC_LMFG_Z)
basicplot <- ggplot(rocdata, aes(m = M, d = D)) + geom_roc()
basicplot
basicplot +
style_roc(theme = theme_grey) +
theme(axis.text = element_text(colour = "blue")) +
ggtitle("PTSD Diagnosis") +
annotate("text", x = .75, y = .25,
label = paste("AUC =", round(calc_auc(basicplot)$AUC, 2))) +
scale_x_continuous("1 - Specificity", breaks = seq(0, 1, by = .05))
rocdata <- data.frame(D = all_paths$PTSD,
M = all_paths$pC_LIPL_Z + all_paths$PCC_MPFG_Z + all_paths$pC_LMFG_Z)
basicplot <- ggplot(rocdata, aes(m = M, d = D)) + geom_roc()
basicplot
basicplot +
style_roc(theme = theme_grey) +
theme(axis.text = element_text(colour = "blue")) +
ggtitle("PTSD Diagnosis") +
annotate("text", x = .75, y = .25,
label = paste("AUC =", round(calc_auc(basicplot)$AUC, 2))) +
scale_x_continuous("1 - Specificity", breaks = seq(0, 1, by = .05))
fit1 = glm(all_paths_LR$PTSD ~ all_paths_LR$`pC --> LMFG` + all_paths_LR$`pC --> LIPL`, family = 'binomial')
all_paths <- read.csv("/Users/thomasvanasse/Google Drive/Research/PTSD/Log_Regression/sig_coefficients_v1.csv")
rocdata <- data.frame(D = all_paths$PTSD,
M = all_paths$pC_LIPL_Z_ + all_paths$PCC_MPFG_Z_ + all_paths$pC_LMFG_Z_)
basicplot <- ggplot(rocdata, aes(m = M, d = D)) + geom_roc()
basicplot
basicplot +
style_roc(theme = theme_grey) +
theme(axis.text = element_text(colour = "blue")) +
ggtitle("PTSD Diagnosis") +
annotate("text", x = .75, y = .25,
label = paste("AUC =", round(calc_auc(basicplot)$AUC, 2))) +
scale_x_continuous("1 - Specificity", breaks = seq(0, 1, by = .05))
fit1 = glm(all_paths_LR$PTSD ~ all_paths_LR$`pC --> LMFG` + all_paths_LR$`pC --> LIPL`, family = 'binomial')
all_paths <- read.csv("/Users/thomasvanasse/Google Drive/Research/PTSD/Log_Regression/sig_coefficients_v1_noHC.csv.csv")
ROC(form=all_paths$PTSD~all_paths$pC_LMFG_Z)
all_paths <- read.csv("/Users/thomasvanasse/Google Drive/Research/PTSD/Log_Regression/sig_coefficients_v1_noHC.csv.csv")
all_paths <- read.csv("/Users/thomasvanasse/Google Drive/Research/PTSD/Log_Regression/sig_coefficients_v1_noHC.csv")
ROC(form=all_paths$PTSD~all_paths$pC_LMFG_Z)
library(plotROC)
library(pROC)
library(Epi)
all_paths <- read.csv("/Users/thomasvanasse/Google Drive/Research/PTSD/Log_Regression/sig_coefficients_v1_noHC.csv")
ROC(form=all_paths$PTSD~all_paths$pC_LMFG_Z)
rocdata <- data.frame(D = all_paths$PTSD,
M = all_paths$pC_LIPL_Z_ + all_paths$PCC_MPFG_Z_ + all_paths$pC_LMFG_Z_)
basicplot <- ggplot(rocdata, aes(m = M, d = D)) + geom_roc()
basicplot
basicplot +
style_roc(theme = theme_grey) +
theme(axis.text = element_text(colour = "blue")) +
ggtitle("PTSD Diagnosis") +
annotate("text", x = .75, y = .25,
label = paste("AUC =", round(calc_auc(basicplot)$AUC, 2))) +
scale_x_continuous("1 - Specificity", breaks = seq(0, 1, by = .05))
rocdata <- data.frame(D = all_paths$PTSD,
M = all_paths$pC_LIPL_Z + all_paths$PCC_MPFG_Z + all_paths$pC_LMFG_Z)
basicplot <- ggplot(rocdata, aes(m = M, d = D)) + geom_roc()
basicplot
basicplot +
style_roc(theme = theme_grey) +
theme(axis.text = element_text(colour = "blue")) +
ggtitle("PTSD Diagnosis") +
annotate("text", x = .75, y = .25,
label = paste("AUC =", round(calc_auc(basicplot)$AUC, 2))) +
scale_x_continuous("1 - Specificity", breaks = seq(0, 1, by = .05))
rocdata <- data.frame(D = all_paths$PTSD,
M = all_paths$pC_LMFG_Z)
basicplot <- ggplot(rocdata, aes(m = M, d = D)) + geom_roc()
basicplot
basicplot +
style_roc(theme = theme_grey) +
theme(axis.text = element_text(colour = "blue")) +
ggtitle("PTSD Diagnosis") +
annotate("text", x = .75, y = .25,
label = paste("AUC =", round(calc_auc(basicplot)$AUC, 2))) +
scale_x_continuous("1 - Specificity", breaks = seq(0, 1, by = .05))
rocdata <- data.frame(D = all_paths$PTSD,
M = all_paths$pC_LIPL_Z + all_paths$PCC_MPFG_Z + all_paths$pC_LMFG_Z)
basicplot <- ggplot(rocdata, aes(m = M, d = D)) + geom_roc()
basicplot
basicplot +
style_roc(theme = theme_grey) +
theme(axis.text = element_text(colour = "blue")) +
ggtitle("PTSD Diagnosis") +
annotate("text", x = .75, y = .25,
label = paste("AUC =", round(calc_auc(basicplot)$AUC, 2))) +
scale_x_continuous("1 - Specificity", breaks = seq(0, 1, by = .05))
fit1 = glm(all_paths_LR$PTSD ~ all_paths_LR$`pC --> LMFG` + all_paths_LR$`pC --> LIPL`, family = 'binomial')
ROC(form=all_paths$PTSD~all_paths$pC_LMFG_Z)
ROC(form=all_paths$PTSD~all_paths$pC_LMFG_Z_)
all_paths <- read.csv("/Users/thomasvanasse/Google Drive/Research/PTSD/Log_Regression/sig_coefficients_v1_noHC.csv")
ROC(form=all_paths$PTSD~all_paths$pC_LMFG_Z_)
all_paths <- read.csv("/Users/thomasvanasse/Google Drive/Research/PTSD/Log_Regression/sig_coefficients_v1_noHC.csv")
ROC(form=all_paths$PTSD~all_paths$pC_LMFG_Z_)
ROC(form=all_paths$PTSD~all_paths$pC_LMFG_Z_)
rocdata <- data.frame(D = all_paths$PTSD,
M = all_paths$pC_LIPL_Z + all_paths$PCC_MPFG_Z + all_paths$pC_LMFG_Z)
basicplot <- ggplot(rocdata, aes(m = M, d = D)) + geom_roc()
basicplot
basicplot +
style_roc(theme = theme_grey) +
theme(axis.text = element_text(colour = "blue")) +
ggtitle("PTSD Diagnosis") +
annotate("text", x = .75, y = .25,
label = paste("AUC =", round(calc_auc(basicplot)$AUC, 2))) +
scale_x_continuous("1 - Specificity", breaks = seq(0, 1, by = .05))
all_paths <- read.csv("/Users/thomasvanasse/Google Drive/Research/PTSD/Log_Regression/sig_coefficients_v1_noCC.csv")
ROC(form=all_paths$PTSD~all_paths$pC_LMFG_Z_)
ROC(form=all_paths$PTSD~all_paths$pC_LMFG_Z)
all_paths <- read.csv("/Users/thomasvanasse/Google Drive/Research/PTSD/Log_Regression/sig_coefficients_v1_noCC.csv")
ROC(form=all_paths$PTSD~all_paths$pC_LMFG_Z)
rocdata <- data.frame(D = all_paths$PTSD,
M = all_paths$pC_LIPL_Z + all_paths$PCC_MPFG_Z + all_paths$pC_LMFG_Z)
all_paths <- read.csv("/Users/thomasvanasse/Google Drive/Research/PTSD/Log_Regression/sig_coefficients_v1_noCC.csv")
ROC(form=all_paths$PTSD~all_paths$pC_LMFG)
rocdata <- data.frame(D = all_paths$PTSD,
M = all_paths$pC_LIPL_Z + all_paths$PCC_MPFG_Z + all_paths$pC_LMFG_Z)
basicplot <- ggplot(rocdata, aes(m = M, d = D)) + geom_roc()
ROC(form=all_paths$PTSD~all_paths$pC_LMFG)
rocdata <- data.frame(D = all_paths$PTSD,
M = all_paths$pC_LIPL_Z + all_paths$PCC_MPFG_Z + all_paths$pC_LMFG_Z)
basicplot <- ggplot(rocdata, aes(m = M, d = D)) + geom_roc()
basicplot
basicplot +
style_roc(theme = theme_grey) +
theme(axis.text = element_text(colour = "blue")) +
ggtitle("PTSD Diagnosis") +
annotate("text", x = .75, y = .25,
label = paste("AUC =", round(calc_auc(basicplot)$AUC, 2))) +
scale_x_continuous("1 - Specificity", breaks = seq(0, 1, by = .05))
all_paths <- read.csv("/Users/thomasvanasse/Google Drive/Research/PTSD/Log_Regression/sig_coefficients_v1_noCC.csv")
ROC(form=all_paths$PTSD~all_paths$pC_LMFG)
rocdata <- data.frame(D = all_paths$PTSD,
M = all_paths$pC_LIPL + all_paths$PCC_MPFG_Z + all_paths$pC_LMFG_Z)
rocdata <- data.frame(D = all_paths$PTSD,
M = all_paths$pC_LIPL + all_paths$PCC_MPFG + all_paths$pC_LMFG)
basicplot <- ggplot(rocdata, aes(m = M, d = D)) + geom_roc()
basicplot
basicplot +
style_roc(theme = theme_grey) +
theme(axis.text = element_text(colour = "blue")) +
ggtitle("PTSD Diagnosis") +
annotate("text", x = .75, y = .25,
label = paste("AUC =", round(calc_auc(basicplot)$AUC, 2))) +
scale_x_continuous("1 - Specificity", breaks = seq(0, 1, by = .05))
all_paths <- read.csv("/Users/thomasvanasse/Google Drive/Research/PTSD/Log_Regression/sig_coefficients_v1_noHC.csv")
rocdata <- data.frame(D = all_paths$PTSD,
M = all_paths$pC_LIPL_Z_ + all_paths$PCC_MPFG_Z_ + all_paths$pC_LMFG_Z_)
basicplot <- ggplot(rocdata, aes(m = M, d = D)) + geom_roc()
basicplot
basicplot +
style_roc(theme = theme_grey) +
theme(axis.text = element_text(colour = "blue")) +
ggtitle("PTSD Diagnosis") +
annotate("text", x = .75, y = .25,
label = paste("AUC =", round(calc_auc(basicplot)$AUC, 2))) +
scale_x_continuous("1 - Specificity", breaks = seq(0, 1, by = .05))
rocdata <- data.frame(D = all_paths$PTSD,
M = all_paths$pC_LIPL_Z + all_paths$PCC_MPFG_Z + all_paths$pC_LMFG_Z)
basicplot <- ggplot(rocdata, aes(m = M, d = D)) + geom_roc()
basicplot
basicplot +
style_roc(theme = theme_grey) +
theme(axis.text = element_text(colour = "blue")) +
ggtitle("PTSD Diagnosis") +
annotate("text", x = .75, y = .25,
label = paste("AUC =", round(calc_auc(basicplot)$AUC, 2))) +
scale_x_continuous("1 - Specificity", breaks = seq(0, 1, by = .05))
all_paths <- read.csv("/Users/thomasvanasse/Google Drive/Research/PTSD/Log_Regression/sig_coefficients_v1_noCC.csv")
rocdata <- data.frame(D = all_paths$PTSD,
M = all_paths$pC_LIPL_Z_ + all_paths$PCC_MPFG_Z_ + all_paths$pC_LMFG_Z_)
basicplot <- ggplot(rocdata, aes(m = M, d = D)) + geom_roc()
basicplot
basicplot +
style_roc(theme = theme_grey) +
theme(axis.text = element_text(colour = "blue")) +
ggtitle("PTSD Diagnosis") +
annotate("text", x = .75, y = .25,
label = paste("AUC =", round(calc_auc(basicplot)$AUC, 2))) +
scale_x_continuous("1 - Specificity", breaks = seq(0, 1, by = .05))
devtools::install_github("sachsmc/plotROC")
library(plotROC)
library(pROC)
all_paths <- read.csv("/Users/thomasvanasse/Google Drive/Research/PTSD/Log_Regression/sig_coefficients_v1.csv")
ROC(form=all_paths$PTSD~all_paths$pC_LMFG)
library(plotROC)
library(pROC)
library(Epi)
all_paths <- read.csv("/Users/thomasvanasse/Google Drive/Research/PTSD/Log_Regression/sig_coefficients_v1.csv")
rocdata <- data.frame(D = all_paths$PTSD,
M = all_paths$pC_LIPL_Z_ + all_paths$PCC_MPFG_Z_ + all_paths$pC_LMFG_Z_)
basicplot <- ggplot(rocdata, aes(m = M, d = D)) + geom_roc()
devtools::install_github("sachsmc/plotROC")
library(plotROC)
library(pROC)
library(Epi)
all_paths <- read.csv("/Users/thomasvanasse/Google Drive/Research/PTSD/Log_Regression/sig_coefficients_v1.csv")
ROC(form=all_paths$PTSD~all_paths$pC_LMFG)
ROC(form=all_paths$PTSD~all_paths$pC_LMFG_Q +pCC_MPFG_Q + pC_LMFG_Q)
all_paths <- read.csv("/Users/thomasvanasse/Google Drive/Research/PTSD/Log_Regression/sig_coefficients_v1.csv")
ROC(form=all_paths$PTSD~all_paths$pC_LMFG_Q +pCC_MPFG_Q + pC_LMFG_Q)
ROC(form=all_paths$PTSD~all_paths$pC_LMFG_Q + all_paths$PCC_MPFG_Q + all_paths$pC_LMFG_Q)
ROC(form=all_paths$PTSD~all_paths$pC_LMFG_Q + all_paths$PCC_MPFG_Q + all_paths$pC_LMFG_Q)
rocdata <- data.frame(D = all_paths$PTSD,
M = all_paths$pC_LIPL_Q + all_paths$PCC_MPFG_Q + all_paths$pC_LMFG_Q)
basicplot <- ggplot(rocdata, aes(m = M, d = D)) + geom_roc()
dev.off()
rocdata <- data.frame(D = all_paths$PTSD,
M = all_paths$pC_LIPL_Q + all_paths$PCC_MPFG_Q + all_paths$pC_LMFG_Q)
basicplot <- ggplot(rocdata, aes(m = M, d = D)) + geom_roc()
basicplot
basicplot +
style_roc(theme = theme_grey) +
theme(axis.text = element_text(colour = "blue")) +
ggtitle("PTSD Diagnosis") +
annotate("text", x = .75, y = .25,
label = paste("AUC =", round(calc_auc(basicplot)$AUC, 2))) +
scale_x_continuous("1 - Specificity", breaks = seq(0, 1, by = .05))
all_paths <- read.csv("/Users/thomasvanasse/Google Drive/Research/PTSD/Log_Regression/sig_coefficients_v1.csv")
devtools::install_github("sachsmc/plotROC")
library(plotROC)
library(pROC)
library(Epi)
all_paths <- read.csv("/Users/thomasvanasse/Google Drive/Research/PTSD/Log_Regression/sig_coefficients_v1.csv")
ROC(form=all_paths$PTSD~all_paths$pC_LMFG_Q + all_paths$PCC_MPFG_Q + all_paths$pC_LMFG_Q)
all_paths <- read.csv("/Users/thomasvanasse/Google Drive/Research/PTSD/Log_Regression/sig_coefficients_v1.csv")
ROC(form=all_paths$PTSD~all_paths$pC_LMFG_Q + all_paths$PCC_MPFG_Q + all_paths$pC_LMFG_Q)
rocdata <- data.frame(D = all_paths$PTSD,
M = all_paths$pC_LIPL_Q + all_paths$PCC_MPFG_Q + all_paths$pC_LMFG_Q)
basicplot <- ggplot(rocdata, aes(m = M, d = D)) + geom_roc()
basicplot
basicplot +
style_roc(theme = theme_grey) +
theme(axis.text = element_text(colour = "blue")) +
ggtitle("PTSD Diagnosis") +
annotate("text", x = .75, y = .25,
label = paste("AUC =", round(calc_auc(basicplot)$AUC, 2))) +
scale_x_continuous("1 - Specificity", breaks = seq(0, 1, by = .05))
basicplot <- ggplot(rocdata, aes(m = M, d = D)) + geom_roc()
basicplot
basicplot +
style_roc(theme = theme_grey) +
theme(axis.text = element_text(colour = "blue")) +
ggtitle("PTSD Diagnosis") +
annotate("text", x = .75, y = .25,
label = paste("AUC =", round(calc_auc(basicplot)$AUC, 2))) +
scale_x_continuous("1 - Specificity", breaks = seq(0, 1, by = .05))
ROC(form=all_paths$PTSD~all_paths$pC_LMFG_Q + all_paths$PCC_MPFG_Q + all_paths$pC_LMFG_Q)
ROC(form=all_paths$PTSD~all_paths$pC_LIPL_Q + all_paths$PCC_MPFG_Q + all_paths$pC_LMFG_Q)
rocdata <- data.frame(D = all_paths$PTSD,
M = all_paths$pC_LIPL_Q + all_paths$PCC_MPFG_Q + all_paths$pC_LMFG_Q)
basicplot <- ggplot(rocdata, aes(m = M, d = D)) + geom_roc()
basicplot
basicplot +
style_roc(theme = theme_grey) +
theme(axis.text = element_text(colour = "blue")) +
ggtitle("PTSD Diagnosis") +
annotate("text", x = .75, y = .25,
label = paste("AUC =", round(calc_auc(basicplot)$AUC, 2))) +
scale_x_continuous("1 - Specificity", breaks = seq(0, 1, by = .05))
dev.off()
install.package("ROCR")
install.packages("ROCR")
library(ROCR)
pred <- prediction(all_paths$pC_LIPL_Q,all_paths$PTSD)
pred <- prediction(all_paths$pC_LIPL_Q,all_paths$PTSD)
roc.perf = performance(pred, measure = "tpr", x.measure = "fpr")
plot(roc.perf)
abline(a=0, b= 1)
pred <- prediction(all_paths$pC_LIPL_Q + all_paths$PCC_MPFG_Q,all_paths$PTSD)
roc.perf = performance(pred, measure = "tpr", x.measure = "fpr")
plot(roc.perf)
abline(a=0, b= 1)
pred <- prediction(all_paths$pC_LIPL_Q + all_paths$PCC_MPFG_Q + all_paths$pC_LMFG,all_paths$PTSD)
roc.perf = performance(pred, measure = "tpr", x.measure = "fpr")
plot(roc.perf)
abline(a=0, b= 1)
ROC(form=all_paths$PTSD~all_paths$pC_LIPL_Q + all_paths$PCC_MPFG_Q + all_paths$pC_LMFG_Q)
rocdata <- data.frame(D = all_paths$PTSD,
M = all_paths$pC_LIPL_Q + all_paths$PCC_MPFG_Q + all_paths$pC_LMFG_Q)
basicplot <- ggplot(rocdata, aes(m = M, d = D)) + geom_roc()
basicplot
basicplot +
style_roc(theme = theme_grey) +
theme(axis.text = element_text(colour = "blue")) +
ggtitle("PTSD Diagnosis") +
annotate("text", x = .75, y = .25,
label = paste("AUC =", round(calc_auc(basicplot)$AUC, 2))) +
scale_x_continuous("1 - Specificity", breaks = seq(0, 1, by = .05))
pred <- prediction(all_paths$pC_LIPL_Q + all_paths$PCC_MPFG_Q + all_paths$pC_LMFG,all_paths$PTSD)
roc.perf = performance(pred, measure = "tpr", x.measure = "fpr")
plot(roc.perf)
abline(a=0, b= 1)
library(gplots)
library(cluster)
library(dendextend)
library(RColorBrewer)
library(gplots)
library(cluster)
library(gplots)
library(cluster)
library(dendextend)
library(RColorBrewer)
setwd(".../")
pwd
cwd
getwd
getwd()
setwd("/Users/thomasvanasse/Google Drive/RESEARCH/METHODS/Methods_work/SHARED_DATA/HCA/")
mat <- data.matrix(read.csv("data_mat.csv", header = FALSE, sep = ","))
setwd("/Users/thomasvanasse/Google Drive/RESEARCH/METHODS/Methods_work/SHARED_DATA/HCA/Hierarchical_Clustering_VBM_ICA/")
mat <- data.matrix(read.csv("data_mat.csv", header = FALSE, sep = ","))
icd_names <- read.csv("ICD_labels.csv", header = FALSE, sep=",")
col_names <- read.csv("component_labels.csv", header = FALSE, sep=",")
rownames(mat)<-t(icd_names)
colnames(mat)<-t(col_names)
dissimilarity <- 1 - cor(t(mat), method="pearson")
rd <- as.dist(dissimilarity)
rc<-hclust(rd, "average")
cd<-dist(t(mat))
dissimilarity_c <- 1 - cor(mat, method="pearson")
cd <- as.dist(dissimilarity_c)
cc<-hclust(cd, "average")
cd_c<-dist(mat)
cor(rd, cophenetic(rc))
cor(cd, cophenetic(cc))
dend1 <- as.dendrogram(rc)
dend2 <- as.dendrogram(cc)
max(mat)
min(mat)
colors<- c(seq(-0.05, 0.024, length.out=40),seq(0.025, 0.18,length.out=80))
qual_col_pals = brewer.pal.info[brewer.pal.info$category == 'qual',]
col_vector = unlist(mapply(brewer.pal, qual_col_pals$maxcolors, rownames(qual_col_pals)))
par(mfrow=c(1,2))
mydist <- function(x) as.dist((1-cor(t(x))))
mycluster <- function(x, k) list(cluster=cutree(hclust(mydist(x), method = "average"),k=k))
myclusGap <- clusGap(t(mat),
FUN = mycluster,
K.max = 18,
B = 100)
plot(myclusGap, main="Component Gap Statistic", ylim=c(-0.10,0.30))
abline(v=c(9), lty=2)
mydist <- function(x) as.dist((1-cor(t(x))))
mycluster <- function(x, k) list(cluster=cutree(hclust(mydist(x), method = "average"),k=k))
myclusGap <- clusGap(mat,
FUN = mycluster,
K.max = 30,
B = 100)
plot(myclusGap, main="Disease Gap Statistic")
abline(v=c(11), lty=2)
par(mfrow=c(1,2))
require(cluster)
hsilo=c()
for (i in 2:16){
hsil <- silhouette(cutree(cc, k = i), cd)
hsilo[i]<-summary(hsil)$avg.width
print(hsilo[i])
}
plot(hsilo, ylab = "Average Silhouette Width",
xlab="K Clusters", main="Components")
abline(v=c(9), lty=2)
lines(hsilo)
sil_cl <- silhouette(cutree(cc, k = 9), cd)
rownames(sil_cl) <- t(col_names)
plot(sil_cl, main = "Silhouette of Component Clusters")
hsilo_dis=c()
for (i in 2:35){
hsil <- silhouette(cutree(rc, k = i), rd)
hsilo_dis[i]<-summary(hsil)$avg.width
print(hsilo_dis[i])
}
plot(hsilo_dis, ylab = "Average Silhouette Width",
xlab="K Clusters", main = "Diseases")
abline(v=c(11),lty=2)
lines(hsilo_dis)
c23 <- col_vector[1:11]
sil_cl <- silhouette(cutree(rc, k = 11), rd)
rownames(sil_cl) <- t(icd_names)
plot(sil_cl, main = "Silhouette of Disease Clusters")
dend1 <- color_branches(dend1, k =11, col = col_vector)
dend2 <- color_branches(dend2, k = 9, col = col_vector)
col_labels <- get_leaves_branches_col(dend1)
column_col_labels <- get_leaves_branches_col(dend2)
col_labels <- col_labels[order(order.dendrogram(dend1))]
column_col_labels <- column_col_labels[order(order.dendrogram(dend2))]
heatmap.2(mat,
Rowv=dend1,
Colv=dend2,
breaks=colors,
symm=F,
symkey=F,
margins=c(5,18),
trace="none",
density.info='histogram',
RowSideColors=col_labels,
ColSideColors=column_col_labels,
cexRow=0.98, #font: cex = 0.2 + 1/log10(nr)
cexCol=1.3) # to add nice colored strips
